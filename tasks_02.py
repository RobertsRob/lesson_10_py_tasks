# 1.task
# У вас есть таблица с продажами товаров. Каждый товар имеет название, цену, количество в наличии и количество проданных единиц.
# Необходимо вычислить, сколько товаров продано, затем для каждого товара создать новый столбец, который будет показывать процент продаж от общего количества. 
# После этого отсортировать товары по убыванию процента продаж.

data = {'Product': ['Товар A', 'Товар B', 'Товар C', 'Товар D'],
        'Price': [500, 300, 150, 200],
        'Quantity': [10, 20, 5, 15],
        'Sold': [7, 18, 3, 12]}

df = pd.DataFrame(data)

df['Total Sold'] = df['Sold'] / df['Quantity'] * 100
df_sorted = df.sort_values('Total Sold', ascending=False)

print(df_sorted)



# 2.task
# Есть таблица с данными о сотрудниках компании, включающая имя, должность, зарплату и дату поступления на работу. 
# Задача состоит в том, чтобы отсортировать сотрудников по зарплате в порядке убывания и выбрать только тех, кто работает в компании более 5 лет (работал до 2019-12-31). 
# Далее нужно удалить столбец с датой поступления на работу.

data = {'Name': ['Алексей', 'Ольга', 'Иван', 'Елена', 'Дмитрий'],
        'Position': ['Менеджер', 'Разработчик', 'Менеджер', 'HR', 'Разработчик'],
        'Salary': [70000, 85000, 60000, 55000, 90000],
        'Hire Date': ['2015-06-15', '2018-02-20', '2017-08-10', '2020-03-25', '2016-05-17']}

df = pd.DataFrame(data)

df['Hire Date'] = pd.to_datetime(df['Hire Date'])
df_filtered = df[df['Hire Date'] <= '2018-12-31']
df_filtered = df_filtered.sort_values('Salary', ascending=False)

df_filtered = df_filtered.drop(columns=['Hire Date'])

print(df_filtered)



# 3.task
# У вас есть таблица с данными о книгах в библиотеке: название, автор, год издания, количество страниц и количество копий.
# Нужно отфильтровать книги, выпущенные после 2000 года, и затем отсортировать их по количеству страниц в порядке убывания.
# После этого добавьте столбец, который будет показывать, является ли книга редкой (если количество копий меньше 5).

data = {'Title': ['Книга 1', 'Книга 2', 'Книга 3', 'Книга 4', 'Книга 5'],
        'Author': ['Автор A', 'Автор B', 'Автор C', 'Автор D', 'Автор E'],
        'Year': [1999, 2005, 2010, 2000, 2018],
        'Pages': [300, 150, 500, 350, 200],
        'Copies': [3, 10, 2, 8, 1]}

df = pd.DataFrame(data)

df_filtered = df[df['Year'] > 2000].sort_values('Pages', ascending=False)
df_filtered['Is_Rare'] = df_filtered['Copies'] < 5

print(df_filtered)



# 4.task
# Есть таблица с данными о клиентах магазина: имя, дата рождения, покупка (общая сумма), дата последней покупки.
# Необходимо найти клиентов, которые потратили больше 50 евро и сделали покупку в последний месяц (позже 2024-11-01) . Затем удалите столбец с датой последней покупки.

data = {'Name': ['Иван', 'Анна', 'Петр', 'Мария', 'Сергей'],
        'Birth Date': ['1990-06-15', '1995-12-20', '1987-03-10', '1992-11-11', '1989-07-30'],
        'Purchase': [60, 45, 120, 40, 100],
        'Last Purchase Date': ['2024-11-03', '2024-11-05', '2024-11-20', '2024-10-15', '2024-11-30']}

df = pd.DataFrame(data)

df['Last Purchase Date'] = pd.to_datetime(df['Last Purchase Date'])
df_filtered = df[(df['Purchase'] > 50) & (df['Last Purchase Date'] > '2024-11-01')]
df_filtered = df_filtered.drop(columns=['Last Purchase Date'])

print(df_filtered)


